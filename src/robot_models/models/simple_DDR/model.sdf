<sdf version='1.9'>
    <model name='simple_ddr' canonical_link='base_link'>

        <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
            <left_joint>joint_wheelL</left_joint>
            <right_joint>joint_wheelR</right_joint>
            <wheel_separation>0.4</wheel_separation>
            <wheel_radius>0.1</wheel_radius>
            <odom_publish_frequency>0.1</odom_publish_frequency>
        </plugin>

		<plugin
			filename="gz-sim-sensors-system"
			name="gz::sim::systems::Sensors">
			<render_engine>ogre2</render_engine>
		</plugin>

		
        <link name='base_link'>
          <pose>0 0 0 0 0 0</pose>

            <inertial>
                <mass>1.0</mass>
                <inertia>
                    <ixx>0.011041666666666665</ixx>
                    <ixy>0.0</ixy>
                    <ixz>0.0</ixz>
                    <iyy>0.02604166666666667</iyy>
                    <iyz>0.0</iyz>
                    <izz>0.03541666666666667</izz>
                </inertia>
            </inertial>

            <collision name='base_link'>
              <pose>0 0 0 0 0 0</pose>
              <geometry>
                <box>
                  <size>0.55 0.35 0.1</size>
                </box>
              </geometry>
            </collision>

            <visual name='base_link'>
              <pose>0 0 0 0 0 0</pose>
              <geometry>
                <box>
                  <size>0.55 0.35 0.1</size>
                </box>
              </geometry>

              <material>
                  <ambient>0.0 0.6 0.6 1</ambient>
                  <diffuse>0.0 0.6 0.6 1</diffuse>
                  <specular>0.0 0.6 0.6 1</specular>
              </material>
            </visual>

			<sensor name="imu_sensor" type="imu">
				<always_on>1</always_on>
				<update_rate>1</update_rate>
				<visualize>true</visualize>
				<topic>imu</topic>
			</sensor>
			
			<sensor name='gpu_lidar' type='gpu_lidar'>"
				<pose relative_to='lidar_frame'>0 0 0 0 0 0</pose>
				<topic>lidar</topic>
				<update_rate>10</update_rate>
				<lidar>
					<scan>
						<horizontal>
							<samples>640</samples>
							<resolution>0.01</resolution>
							<min_angle>-1.396263</min_angle>
							<max_angle>1.396263</max_angle>
						</horizontal>
						<vertical>
							<samples>1</samples>
							<resolution>0.01</resolution>
							<min_angle>0</min_angle>
							<max_angle>0</max_angle>
						</vertical>
					</scan>
					<range>
						<min>0.08</min>
						<max>10.0</max>
						<resolution>0.01</resolution>
					</range>
				</lidar>
				<always_on>1</always_on>
				<visualize>1</visualize>
			</sensor>
        </link>
      
		<joint name='joint_wheelL' type='revolute'>
			<pose relative_to='base_link'>-0.2 -0.2 0.0 0 0 0</pose>
			<parent>base_link</parent>
			<child>wheelL</child>
			<axis>
			<xyz>0 1 0</xyz>
			<limit>
				<lower>-inf</lower>
				<upper>inf</upper>
			</limit>
			<dynamics>
				<damping>10</damping>
				<friction>1</friction>
				<spring_reference>0</spring_reference>
				<spring_stiffness>0</spring_stiffness>
			</dynamics>
			</axis>
		</joint>
		
		<link name='wheelL'>
			<pose relative_to='joint_wheelL'>0 0 0 0 0 0</pose>
			<inertial>
			<pose>0 0 0 0 0 0</pose>
			<mass>0.050000000000000003</mass>
			<inertia>
				<ixx>0.001625000000000001</ixx>
				<ixy>0</ixy>
				<ixz>0</ixz>
				<iyy>0.00025000000000000011</iyy>
				<iyz>0</iyz>
				<izz>0.001625000000000001</izz>
			</inertia>
			</inertial>
			<collision name='wheelL_collision'>
			<pose>0 0 0 -1.5707963300000001 0 0</pose>
			<geometry>
				<cylinder>
				<length>0.050000000000000003</length>
				<radius>0.10000000000000001</radius>
				</cylinder>
			</geometry>
			</collision>
			<visual name='wheelL_visual'>
			<pose>0 0 0 -1.5707963300000001 0 0</pose>
			<geometry>
				<cylinder>
				<length>0.050000000000000003</length>
				<radius>0.10000000000000001</radius>
				</cylinder>
			</geometry>

				<material>
					<ambient>1.0 0.0 0.0 1</ambient>
					<diffuse>1.0 0.0 0.0 1</diffuse>
					<specular>1.0 0.0 0.0 1</specular>
				</material>
			</visual>
		</link>

		<joint name='joint_wheelR' type='revolute'>
			<pose relative_to='base_link'>-0.2 0.2 0.0 0 0 0</pose>
			<parent>base_link</parent>
			<child>wheelR</child>
			<axis>
			<xyz>0 1 0</xyz>
			<limit>
				<lower>-inf</lower>
				<upper>inf</upper>
			</limit>
			<dynamics>
				<damping>10</damping>
				<friction>1</friction>
				<spring_reference>0</spring_reference>
				<spring_stiffness>0</spring_stiffness>
			</dynamics>
			</axis>
		</joint>

		<link name='wheelR'>
			<pose relative_to='joint_wheelR'>0 0 0 0 0 0</pose>
			<inertial>
			<pose>0 0 0 0 0 0</pose>
			<mass>0.050000000000000003</mass>
			<inertia>
				<ixx>0.001625000000000001</ixx>
				<ixy>0</ixy>
				<ixz>0</ixz>
				<iyy>0.00025000000000000011</iyy>
				<iyz>0</iyz>
				<izz>0.001625000000000001</izz>
			</inertia>
			</inertial>
			<collision name='wheelR_collision'>
			<pose>0 0 0 -1.5707963300000001 0 0</pose>
			<geometry>
				<cylinder>
				<length>0.050000000000000003</length>
				<radius>0.10000000000000001</radius>
				</cylinder>
			</geometry>
			</collision>
			<visual name='wheelR_visual'>
			<pose>0 0 0 -1.5707963300000001 0 0</pose>
			<geometry>
				<cylinder>
				<length>0.050000000000000003</length>
				<radius>0.10000000000000001</radius>
				</cylinder>
			</geometry>
				<material>
					<ambient>1.0 0.0 0.0 1</ambient>
					<diffuse>1.0 0.0 0.0 1</diffuse>
					<specular>1.0 0.0 0.0 1</specular>
				</material>
			</visual>
		</link>

		<link name='caster'>
			<pose relative_to='joint_caster'>0 0 0.0 0 0 0</pose>
			<inertial>
				<pose>0 0 0 0 0 0</pose>
				<mass>0.005</mass>
				<inertia>
					<ixx>0.001625000000000001</ixx>
					<ixy>0</ixy>
					<ixz>0</ixz>
					<iyy>0.00025000000000000011</iyy>
					<iyz>0</iyz>
					<izz>0.001625000000000001</izz>
				</inertia>
			</inertial>
			<collision name='caster_collision'>
				<geometry>
					<sphere>
						<radius>0.025</radius>
					</sphere>
				</geometry>
				<surface>
					<friction>
						<ode>
							<mu> 0.0 </mu>
							<mu2> 0.0 </mu2>
						</ode>
					</friction>
				</surface>
			</collision>
			<visual name='caster_visual'>
				<geometry>
					<sphere>
						<radius>0.025</radius>
					</sphere>
				</geometry>
			</visual>
		</link>

		<joint name='joint_caster' type='fixed'>
			<pose relative_to='base_link'>0.2 0 -0.075 0 0 0</pose>
			<parent>base_link</parent>
			<child>caster</child>
		</joint>
      
		<frame name='joint_body' attached_to='base_link'>
			<pose>0 0 0 0 0 0</pose>
		</frame>

		<frame name="lidar_frame" attached_to='base_link'>
			<pose>0.1 0 0.3 0 0 0</pose>
		</frame>

    </model>
</sdf>
